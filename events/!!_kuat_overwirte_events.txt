namespace = leader
# New Admiral
country_event = {
	id = leader.1
	title = "leader.1.name"
	desc = {
		trigger = { has_authority = auth_hive_mind }
		text = "leader.1.desc.hive"
	}
	desc = {
		trigger = { has_authority = auth_machine_intelligence }
		text = "leader.1.desc.machine"
	}
	desc = {
		trigger = {
			NOR = {
				has_authority = auth_hive_mind
				has_authority = auth_machine_intelligence
			}
		}
		text = "leader.1.desc"
	}
	picture = GFX_evt_federation_fleet
	location = ROOT

	is_triggered_only = yes

	trigger = { always = no }

	immediate = {
		FROMFROM = {
			solar_system = { save_event_target_as = system }
			random_controlled_ship = {
				save_event_target_as = ship
			}
		}
		random_list = {
			25 = {
				create_leader = {
					class = commander
					species = owner_main_species
					name = random
					skill = 2
					traits = {
						trait = leader_trait_gale_speed
						trait = leader_trait_aggressive
					}
				}
				last_created_leader = { save_event_target_as = officer }
			}
			25 = {
				create_leader = {
					class = commander
					species = owner_main_species
					name = random
					skill = 2
					traits = {
						trait = leader_trait_aggressive
						trait = leader_trait_engineer
					}
				}
				last_created_leader = { save_event_target_as = officer }
			}
			25 = {
				create_leader = {
					class = commander
					species = owner_main_species
					name = random
					skill = 2
					traits = {
						trait = leader_trait_fleet_logistician
						trait = leader_trait_cautious
					}
				}
				last_created_leader = { save_event_target_as = officer }
			}
			25 = {
				create_leader = {
					class = commander
					species = owner_main_species
					name = random
					skill = 2
					traits = {
						trait = leader_trait_scout
						trait = leader_trait_trickster
					}
				}
				last_created_leader = { save_event_target_as = officer }
			}
		}
	}

	option = {
		name = GOOD
		custom_tooltip = new_admiral
	}
}

namespace = crisis
country_event = {
	id = crisis.6052
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		every_playable_country = {
			limit = {
				is_ai = no
				NOT = { is_same_value = root }
			}
			country_event = { id = crisis.6051 }
		}
		set_update_modifiers_batch = begin
		every_system = { 
			limit = { kuat_is_kuat_system = no }
			destroy_star_system = yes
		}
		set_update_modifiers_batch = end
		win = yes
	}
}

country_event = { # Thesis effect randomizer
	id = crisis.7200
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		last_increased_tech = tech_cosmogenesis_thesis
	}

	immediate = {
		random_list = {
			2 = { #Blackout
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_blackout
				}
				set_country_flag = cosmogenesis_thesis_blackout_initiator
				every_playable_country = {
					country_event = { id = crisis.7205 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_blackout
				set_theses_flags = yes
			}
			2 = { #Constant Rounding
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_constant
				}
				set_country_flag = cosmogenesis_thesis_constant_initiator
				every_playable_country = {
					country_event = { id = crisis.7210 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_constant
				set_theses_flags = yes
			}
			1 = { #Superlight
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_superlight
				}
				set_country_flag = cosmogenesis_thesis_superlight_initiator
				every_playable_country = {
					country_event = { id = crisis.7215 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_superlight
				set_theses_flags = yes
			}
			1 = { #Alloy Ductility - Good
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_alloy_ductility
				}
				set_country_flag = cosmogenesis_thesis_alloy_ductility_initiator
				every_playable_country = {
					country_event = { id = crisis.7235 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_alloy_ductility
				set_theses_flags = yes
			}
			1 = { #Alloy Ductility - Bad
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_alloy_ductility
				}
				set_country_flag = cosmogenesis_thesis_alloy_ductility_initiator
				every_playable_country = {
					country_event = { id = crisis.7240 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_alloy_ductility
				set_theses_flags = yes
			}
			1 = { #Altered Nutrition - Good
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_altered_nutrition
				}
				set_country_flag = cosmogenesis_thesis_altered_nutrition_initiator
				every_playable_country = {
					country_event = { id = crisis.7245 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_altered_nutrition
				set_theses_flags = yes
			}
			1 = { #Altered Nutrition - Bad
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_altered_nutrition
				}
				set_country_flag = cosmogenesis_thesis_altered_nutrition_initiator
				every_playable_country = {
					country_event = { id = crisis.7250 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_altered_nutrition
				set_theses_flags = yes
			}
			2 = { #Mass Shift
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_mass_shift
				}
				set_country_flag = cosmogenesis_thesis_mass_shift_initiator
				every_playable_country = {
					country_event = { id = crisis.7255 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_mass_shift
				set_theses_flags = yes
			}
			2 = { #Shroud Tears
				modifier = {
					factor = 0
					has_global_flag = cosmogenesis_thesis_shroud_tear
				}
				set_country_flag = cosmogenesis_thesis_shroud_tear_initiator
				every_playable_country = {
					country_event = { id = crisis.7260 days = 1 }
				}
				set_global_flag = cosmogenesis_thesis_shroud_tear
				set_theses_flags = yes
			}
			4 = { #Filler - Good
				country_event = { id = crisis.7265 days = 1 }
			}
			8 = { # Filler - Bad
				modifier = { #Reduce the likelihood of bad outcome if you know more about what you're doing
					add = -2
					resource_stockpile_compare = {
						resource = advanced_logic
						value >= 17000
					}
				}
				modifier = {
					add = -2
					resource_stockpile_compare = {
						resource = advanced_logic
						value >= 21000
					}
				}
				modifier = {
					add = -2
					resource_stockpile_compare = {
						resource = advanced_logic
						value >= 26000
					}
				}
				country_event = { id = crisis.7270 days = 1 }
			}
		}
		change_variable = {
			which = applied_infinity_thesis
			value = +1
		}
	}
}

namespace = grand_archive
# Catalytic Bladder unique mutation damage upon death
country_event = {
	id = grand_archive.10090
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		always = no
	}

	immediate = {
		set_variable = {
			which = local_damage_percentage
			value = fromfrom.value:scripted_modifier_add|MODIFIER|damage_random_nearby_enemy_on_death|
		}
		if = {
			limit = {
				check_variable = { which = local_damage_percentage value > 0 }
			}
			fromfrom.solar_system = {
				random_ship_in_system = {
					limit = {
						owner = {
							is_same_value = root.from
						}
						distance = {
							source = root.fromfrom
							max_distance <= 30
							same_solar_system = yes
						}
					}

					root.fromfrom = {
						export_trigger_value_to_variable = {
							trigger = has_max_hp
							variable = local_max_hp
						}
						export_trigger_value_to_variable = {
							trigger = has_max_armor_hp
							variable = local_max_armor_hp
						}
					}
					change_variable = {
						which = local_damage_value
						value = local_max_hp
					}
					change_variable = {
						which = local_damage_value
						value = local_max_armor_hp
					}
					multiply_variable = {
						which = local_damage_value
						value = local_damage_percentage
					}
					damage_ship = local_damage_value
				}
			}

			play_sound = { # Sound played on ship explosion
				sound = ga_weapon_catalytic_bladder
				location = fromfrom
			}
		}
	}
}