namespace = kuat_shipyard
#通讯主界面
country_event = {
	id = kuat_shipyard.1
	title = kuat_shipyard.title
	desc = kuat_shipyard.1.a.desc
	picture_event_data = {
		portrait = event_target:kuat_player_target_species
		room = kuat_mega_shipyard_room
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
		OR = {
			kuat_shipyard_diplo_event_active = no
			from = { is_same_value = root }
		}
		OR = {
			from = { is_same_value = root }
			from = { is_country_type = kuat_shipyard }
			from = { is_country_type = kuat_fleet_hostile }
			from = { is_country_type = kuat_fleet }
		}
	}
	#TODO
	# option = {
	# 	name = kuat_shipyard.1.c
	# 	trigger = { exists = event_target:fallen_empire_kuat_fleet always = no }
	# 	allow = {
	# 		custom_tooltip = {
	# 			fail_text = kuat_shipyard.1.a.opinion.tooltip
	# 			event_target:fallen_empire_kuat = { opinion = { who = root value >= 500 } }
	# 		}
	# 	}
	# 	hidden_effect = { country_event = { id = kuat_shipyard.5 } }
	# }
	option = {
		name = kuat_shipyard.1.b
		trigger = { exists = event_target:fallen_empire_kuat_fleet }
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.1.b.opinion.tooltip
				is_ai = no
				can_communicate_with_kuat_fleet = yes
				OR = {
					kuat_fleet_diplo_event_active = no
					from = { is_same_value = root }
				}
			}
		}
		hidden_effect = { country_event = { id = executor_build.802 } }
	}
	option = {
		name = kuat_shipyard.1.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.1.a.opinion.tooltip
				OR = {
					AND = {
						has_origin = origin_kuat_shadow
						event_target:fallen_empire_kuat = { opinion = { who = root value >= 50 } }
					}
					AND = { 
						NOT = { has_origin = origin_kuat_shadow }
						has_technology = tech_destroyers
					}
				}
			}
		}
		hidden_effect = { country_event = { id = kuat_shipyard.2 } }
	}
	option = {
		name = kuat_shipyard.exit
		default_hide_option = yes
	}
} 

#建造舰船界面
country_event = {
	id = kuat_shipyard.2
	title = kuat_shipyard.title
	desc = kuat_shipyard.2.desc
	picture_event_data = {
		portrait = event_target:kuat_player_target_species
		room = kuat_mega_shipyard_room
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	immediate = {
		set_variable = { which = dominance_check value = dominance_class_queue }
		set_variable = { which = fallen_empire_escort_check value = fallen_empire_escort_queue }
		set_variable = { which = eclipse_class_check value = eclipse_class_queue }
		every_owned_ship = {
			if = { limit = { is_ship_size = nebula_dominance } prev = { change_variable = { which = dominance_check value = 1 } } }
			if = { limit = { is_ship_size = Vengeance } prev = { change_variable = { which = fallen_empire_escort_check value = 1 } } }
			if = { limit = { is_ship_size = eclipse } prev = { change_variable = { which = eclipse_class_check value = 1 } } }
		}
	}
	#折磨者
	option = {
		name = kuat_shipyard.2.b
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.2.b.opinion.tooltip
				OR = {
					AND = {
						has_origin = origin_kuat_shadow
						event_target:fallen_empire_kuat = { opinion = { who = root value >= 100 } }
					}
					AND = { 
						NOT = { has_origin = origin_kuat_shadow }
						has_technology = tech_cruisers
					}
				}
			}
		}
		hidden_effect = { 
			country_event = { id = kuat_shipyard.22 } 
			set_country_flag = building_the_horriwer 
			get_variable_screen_alloys = yes
		}
	}
	#帝国
	option = {
		name = kuat_shipyard.2.c
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.2.c.opinion.tooltip
				OR = {
					AND = {
						has_origin = origin_kuat_shadow
						event_target:fallen_empire_kuat = { opinion = { who = root value >= 200 } }
					}
					AND = { 
						NOT = { has_origin = origin_kuat_shadow }
						has_technology = tech_battleships
					}
				}
			}
		}
		hidden_effect = { 
			country_event = { id = kuat_shipyard.23 } 
			set_country_flag = building_the_empire 
			get_variable_screen_alloys = yes
		}
	}
	#复兴级
	option = {
		name = kuat_shipyard.2.d
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.2.d.opinion.tooltip
				OR = {
					AND = {
						has_origin = origin_kuat_shadow
						event_target:fallen_empire_kuat = { opinion = { who = root value >= 300 } }
					}
					AND = { 
						NOT = { has_origin = origin_kuat_shadow }
						has_technology = tech_titans
					}
				}
			}
		}
		hidden_effect = { 
			country_event = { id = kuat_shipyard.24 } 
			set_country_flag = building_the_resugrant 
			get_variable_screen_alloys = yes
		}
	}
	#君权级
	option = {
		name = kuat_shipyard.2.e
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.2.e.opinion.tooltip
				OR = {
					AND = {
						has_origin = origin_kuat_shadow
						event_target:fallen_empire_kuat = { opinion = { who = root value >= 350 } }
					}
					AND = { 
						NOT = { has_origin = origin_kuat_shadow }
						has_technology = tech_titans
					}
				}
			}
			custom_tooltip = {
				fail_text = kuat_shipyard.3.a.opinion.tooltip
				count_owned_ship = { limit = { is_ship_size = nebula_dominance } count < 1 }
				check_variable = { which = dominance_class_queue value < 1 }
				check_variable = { which = dominance_check value < 1 }
			}
		}
		hidden_effect = { 
			country_event = { id = kuat_shipyard.25 } 
			set_country_flag = building_the_donimance 
			get_variable_screen_alloys = yes
		}
	}
	#守门人
	option = {
		name = kuat_shipyard.2.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.3.a.opinion.tooltip
				count_owned_ship = { limit = { is_ship_size = Vengeance } count < 1 }
				check_variable = { which = fallen_empire_escort_queue value < 1 }
				check_variable = { which = fallen_empire_escort_check value < 1 }
			}
			custom_tooltip = {
				fail_text = kuat_shipyard.2.a.opinion.tooltip
				OR = {
					AND = {
						has_origin = origin_kuat_shadow
						event_target:fallen_empire_kuat = { opinion = { who = root value >= 500 } }
					}
					AND = { 
						NOT = { has_origin = origin_kuat_shadow }
						has_technology = tech_titans
					}
				}
			}
		}
		hidden_effect = { 
			country_event = { id = kuat_shipyard.21 } 
			set_country_flag = building_the_Vengeance
			get_variable_screen_alloys = yes
		}
	}
	#日蚀
	option = {
		name = kuat_shipyard.2.f
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.3.a.opinion.tooltip
				count_owned_ship = { limit = { is_ship_size = eclipse } count < 1 }
				check_variable = { which = eclipse_class_queue value < 1 }
				check_variable = { which = eclipse_class_check value < 1 }
			}
			custom_tooltip = {
				fail_text = kuat_shipyard.2.a.opinion.tooltip
				OR = {
					AND = {
						has_origin = origin_kuat_shadow
						event_target:fallen_empire_kuat = { opinion = { who = root value >= 500 } }
					}
					AND = { 
						NOT = { has_origin = origin_kuat_shadow }
						has_technology = tech_titans
					}
				}
			}
		}
		hidden_effect = { 
			country_event = { id = kuat_shipyard.26 } 
			set_country_flag = building_the_eclipse 
			get_variable_screen_alloys = yes
		}
	}	
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 } }
	}
	option = {
		name = kuat_shipyard.exit
		default_hide_option = yes
	}
}

#建造守门人
country_event = {
	id = kuat_shipyard.21
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_escort_queue value > 0 }
		}
		text = kuat_shipyard.21.a.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = fallen_empire_escort_queue }
				check_variable = { which = fallen_empire_escort_queue value = 0 }
			}
		}
		text = kuat_shipyard.21.b.desc
	}
	picture_event_data = { room = Vengance_room }
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.21.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.3.a.opinion.tooltip
				count_owned_ship = { limit = { is_ship_size = Vengeance } count < 1 }
				check_variable = { which = fallen_empire_escort_check value < 1 }
				check_variable = { which = fallen_empire_escort_queue value < 1 }
			}
			custom_tooltip = {
				fail_text = kuat_shipyard.check
				get_variable_alloys_check_allow = yes
			}
		}
		custom_tooltip = kuat_shipyard.21.a.tooltip
		hidden_effect = { get_variable_alloys_bought = yes }
		hidden_effect = {
			change_variable = { which = fallen_empire_escort_queue value = 1 }
			change_variable = { which = fallen_empire_escort_check value = 1 }
			country_event = { id = kuat_shipyard.21 }
			country_event = { id = kuat_shipyard.211 days = @kuat_escort_build_time }
		}
	}
	option = {
		name = kuat_shipyard.21.b
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.21.b.need_queue.tooltip
				check_variable = { which = fallen_empire_escort_queue value > 0 }
			}
		}
		custom_tooltip = kuat_shipyard.21.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			subtract_variable = { which = fallen_empire_escort_queue value = 1 }
			subtract_variable = { which = fallen_empire_escort_check value = 1 }
			country_event = { id = kuat_shipyard.21 }
		}
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 }	remove_country_flag = building_the_Vengeance }
	}
	option = {
		name = kuat_shipyard.exit
		hidden_effect = { remove_country_flag = building_the_Vengeance }
		default_hide_option = yes
	}
}

#守门人到达
country_event = {
	id = kuat_shipyard.211
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = fallen_empire_escort_queue value > 0 }
	}
	immediate = {
		if = {
			limit = { count_owned_ship = { limit = { is_ship_size = Vengeance } count < 1 } }
			capital_scope = {
				create_fleet = {
					settings = { spawn_debris = no }
					effect = {
						set_owner = root
						create_ship = { design = "Name_boss_Venganza" }
						set_location = { target = prev distance = 20 angle = random }
					}
				}
			}
			create_message = {
				type = "CONSTRUCTION_MESSAGE_TYPE"
				localization = "kuat_escort_arrived_desc"
				days = 30
				target = from
				variable = {
					type = name
					localization = "capital_planet"
					scope = root.capital_scope
				}
			}
			subtract_variable = { which = fallen_empire_escort_queue value = 1 }
			if = {
				limit = { check_variable = { which = fallen_empire_escort_queue value <= 0 } }
				clear_variable = fallen_empire_escort_queue
			}
			if = {
				limit = { exists = event_target:fallen_empire_kuat }
				event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
			}
		}
		else = {
			subtract_variable = { which = fallen_empire_escort_queue value = 1 }
			if = {
				limit = { check_variable = { which = fallen_empire_escort_queue value <= 0 } }
				clear_variable = fallen_empire_escort_queue
			}
			if = {
				limit = { exists = event_target:fallen_empire_kuat }
				event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
			}
		}
	}
}

#建造折磨者
country_event = {
	id = kuat_shipyard.22
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_battlecruiser_queue value > 0 }
			check_variable = { which = fallen_empire_battlecruiser_queue value <= 4 }
		}
		text = kuat_shipyard.22.a.desc
	}
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_battlecruiser_queue value > 4 }
		}
		text = kuat_shipyard.22.a5.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = fallen_empire_battlecruiser_queue }
				check_variable = { which = fallen_empire_battlecruiser_queue value = 0 }
			}
		}
		text = kuat_shipyard.22.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = horriwow_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.22.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.check
				get_variable_alloys_check_allow = yes
			}
		}
		custom_tooltip = kuat_shipyard.22.a.tooltip
		hidden_effect = {
			get_variable_alloys_bought = yes
			change_variable = { which = fallen_empire_battlecruiser_queue value = 1 }
			country_event = { id = kuat_shipyard.22 }
			country_event = { id = kuat_shipyard.222 days = @kuat_battlecruiser_build_time }
		}
	}
	option = {
		name = kuat_shipyard.22.b
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.22.b.need_queue.tooltip
				check_variable = { which = fallen_empire_battlecruiser_queue value > 0 }
			}
		}
		custom_tooltip = kuat_shipyard.22.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			subtract_variable = { which = fallen_empire_battlecruiser_queue value = 1 }
			country_event = { id = kuat_shipyard.22 }
		}
	}
	option = {
		name = kuat_shipyard.22.b5
		hidden_effect = { set_country_flag = kuat_build_fifth_ships }
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.22.b.need_queue.tooltip
				check_variable = { which = fallen_empire_battlecruiser_queue value > 4 }
			}
		}
		custom_tooltip = kuat_shipyard.22.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			remove_country_flag = kuat_build_fifth_ships
			subtract_variable = { which = fallen_empire_battlecruiser_queue value = 5 }
			country_event = { id = kuat_shipyard.22 }
		}
	}
	option = {
		name = kuat_shipyard.22.a5
		custom_tooltip = kuat_shipyard.22.a.tooltip
		hidden_effect = { set_country_flag = kuat_build_fifth_ships }
		hidden_effect = { country_event = { id = kuat_shipyard.221 } }
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 } remove_country_flag = building_the_horriwer }
	}
	option = {
		name = kuat_shipyard.exit
		hidden_effect = { remove_country_flag = building_the_horriwer }
		default_hide_option = yes
	}
}

country_event = {
	id = kuat_shipyard.221
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_battlecruiser_queue value > 0 }
			check_variable = { which = fallen_empire_battlecruiser_queue value <= 4 }
		}
		text = kuat_shipyard.22.a.desc
	}
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_battlecruiser_queue value > 4 }
		}
		text = kuat_shipyard.22.a5.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = fallen_empire_battlecruiser_queue }
				check_variable = { which = fallen_empire_battlecruiser_queue value = 0 }
			}
		}
		text = kuat_shipyard.22.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = horriwow_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.confirm
		custom_tooltip = kuat_shipyard.confirm.a.tooltip
		allow = { custom_tooltip = {
			fail_text = kuat_shipyard_queue
			check_variable = { which = horriwer_queue value > 0 } 
		} }
		hidden_effect = { 
			set_variable = { which = horriwer_true_numbers value = horriwer_queue }
			change_variable = { which = fallen_empire_battlecruiser_queue value = horriwer_queue }
			country_event = { id = kuat_shipyard.22 }
			while = {
				count = horriwer_true_numbers
				country_event = { id = kuat_shipyard.222 days = @kuat_battlecruiser_build_time } 
			}
			remove_country_flag = fired_horriwer
			remove_country_flag = kuat_build_fifth_ships 
			clear_variable = horriwer_queue
			clear_variable = horriwer_true_numbers
		}
	}
	option = {
		name = kuat_shipyard.return
		default_hide_option = yes
		hidden_effect = { 
			country_event = { id = kuat_shipyard.22 } 
			remove_country_flag = fired_horriwer
			remove_country_flag = kuat_build_fifth_ships
		}
	}
}

#折磨者到达
country_event = {
	id = kuat_shipyard.222
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = fallen_empire_battlecruiser_queue value > 0 }
	}
	immediate = {
		if = {
			limit = { check_variable = { which = fallen_empire_battlecruiser_queue value > 0 } }
			change_variable = { which = horriwer_fleet_queue value = 1 }
			subtract_variable = { which = fallen_empire_battlecruiser_queue value = 1 }
			country_event = { id = kuat_shipyard.223 days = 1 }
		}
		if = {
			limit = { check_variable = { which = fallen_empire_battlecruiser_queue value <= 0 } }
			clear_variable = fallen_empire_battlecruiser_queue
		}
		if = {
			limit = { exists = event_target:fallen_empire_kuat }
			event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
		}
	}
}

country_event = {
	id = kuat_shipyard.223
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = horriwer_fleet_queue value > 0 }
	}
	immediate = {
		capital_scope = {
			create_fleet = {
				settings = { spawn_debris = no }
				effect = {
					set_owner = root
					while = {
						limit = { root = { check_variable = { which = horriwer_fleet_queue value > 0 } } }
						create_ship = { design = "Name_boss_Horriwer" }
						root = { subtract_variable = { which = horriwer_fleet_queue value = 1 } }
					}
					set_location = { target = prev distance = 20 angle = random }
				}
			}
		}
		set_timed_country_flag = { flag = horriwer_fleet_queue_notification_temple days = 1 }
		country_event = { id = kuat_shipyard.2223 }
	}
}

country_event = {
	id = kuat_shipyard.2223
	hide_window = yes
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = horriwer_fleet_queue_notification_temple } }
	immediate = { create_message = {
		type = "CONSTRUCTION_MESSAGE_TYPE"
		localization = "kuat_battlecruiser_arrived_desc"
		days = 30
		target = from
		variable = { type = name localization = "capital_planet" scope = root.capital_scope }
	} }
}

#建造帝国II
country_event = {
	id = kuat_shipyard.23
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_titan_queue value > 0 }
			check_variable = { which = fallen_empire_titan_queue value <= 4 }
		}
		text = kuat_shipyard.23.a.desc
	}
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_titan_queue value > 4 }
		}
		text = kuat_shipyard.23.a5.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = fallen_empire_titan_queue }
				check_variable = { which = fallen_empire_titan_queue value = 0 }
			}
		}
		text = kuat_shipyard.23.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = Imeprial_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.23.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.check
				get_variable_alloys_check_allow = yes
			}
		}
		custom_tooltip = kuat_shipyard.23.a.tooltip
		hidden_effect = { get_variable_alloys_bought = yes }
		hidden_effect = {
			change_variable = { which = fallen_empire_titan_queue value = 1 }
			country_event = { id = kuat_shipyard.23 }
			country_event = { id = kuat_shipyard.231 days = @kuat_titan_build_time }
		}
	}
	option = {
		name = kuat_shipyard.23.b
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.23.b.need_queue.tooltip
				check_variable = { which = fallen_empire_titan_queue value > 0 }
			}
		}
		custom_tooltip = kuat_shipyard.23.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			subtract_variable = { which = fallen_empire_titan_queue value = 1 }
			country_event = { id = kuat_shipyard.23 }
		}
	}
	option = {
		name = kuat_shipyard.23.b5
		hidden_effect = { set_country_flag = kuat_build_fifth_ships }
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.23.b.need_queue.tooltip
				check_variable = { which = fallen_empire_titan_queue value > 4 }
			}
		}
		custom_tooltip = kuat_shipyard.23.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			remove_country_flag = kuat_build_fifth_ships
			subtract_variable = { which = fallen_empire_titan_queue value = 5 }
			country_event = { id = kuat_shipyard.23 }
		}
	}
	option = {
		name = kuat_shipyard.23.a5
		custom_tooltip = kuat_shipyard.23.a.tooltip
		hidden_effect = { set_country_flag = kuat_build_fifth_ships }
		hidden_effect = { country_event = { id = kuat_shipyard.233 } }
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 } remove_country_flag = building_the_empire }
	}
	option = {
		name = kuat_shipyard.exit
		hidden_effect = { remove_country_flag = building_the_empire }
		default_hide_option = yes
	}
}

country_event = {
	id = kuat_shipyard.233
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_titan_queue value > 0 }
			check_variable = { which = fallen_empire_titan_queue value <= 4 }
		}
		text = kuat_shipyard.23.a.desc
	}
	desc = {
		trigger = {
			check_variable = { which = fallen_empire_titan_queue value > 4 }
		}
		text = kuat_shipyard.23.a5.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = fallen_empire_titan_queue }
				check_variable = { which = fallen_empire_titan_queue value = 0 }
			}
		}
		text = kuat_shipyard.23.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = Imeprial_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.confirm
		custom_tooltip = kuat_shipyard.confirm.b.tooltip
		allow = { custom_tooltip = {
			fail_text = kuat_shipyard_queue
			check_variable = { which = empire_queue value > 0 } 
		} }
		hidden_effect = { 
			set_variable = { which = empire_true_numbers value = empire_queue }
			change_variable = { which = fallen_empire_titan_queue value = empire_queue }
			country_event = { id = kuat_shipyard.23 }
			while = {
				count = empire_true_numbers
				country_event = { id = kuat_shipyard.231 days = @kuat_titan_build_time } 
			}
			remove_country_flag = fired_empire
			remove_country_flag = kuat_build_fifth_ships 
			clear_variable = empire_queue
			clear_variable = empire_true_numbers
		}
	}
	option = {
		name = kuat_shipyard.return
		default_hide_option = yes
		hidden_effect = { 
			country_event = { id = kuat_shipyard.23 } 
			remove_country_flag = fired_empire
			remove_country_flag = kuat_build_fifth_ships
		}
	}
}

#帝国II到达
country_event = {
	id = kuat_shipyard.231
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = fallen_empire_titan_queue value > 0 }
	}
	immediate = {
		if = {
			limit = { check_variable = { which = fallen_empire_titan_queue value > 0 } }
			change_variable = { which = empire_fleet_queue value = 1 }
			subtract_variable = { which = fallen_empire_titan_queue value = 1 }
			country_event = { id = kuat_shipyard.232 days = 1 }
		}
		if = {
			limit = { check_variable = { which = fallen_empire_titan_queue value <= 0 } }
			clear_variable = fallen_empire_titan_queue
		}
		if = {
			limit = { exists = event_target:fallen_empire_kuat }
			event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
		}
	}
}

country_event = {
	id = kuat_shipyard.232
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = empire_fleet_queue value > 0 }
	}
	immediate = {
		capital_scope = {
			create_fleet = {
				settings = { spawn_debris = no }
				effect = {
					set_owner = root
					while = {
						limit = { root = { check_variable = { which = empire_fleet_queue value > 0 } } }
						create_ship = { design = "Name_boss_EMPIRE" }
						root = { subtract_variable = { which = empire_fleet_queue value = 1 } }
					}
					set_location = { target = prev distance = 20 angle = random }
				}
			}
		}
		set_timed_country_flag = { flag = empire_fleet_queue_notification_temple days = 1 }
		country_event = { id = kuat_shipyard.2322 }
	}
}

country_event = {
	id = kuat_shipyard.2322
	hide_window = yes
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = empire_fleet_queue_notification_temple } }
	immediate = { create_message = {
		type = "CONSTRUCTION_MESSAGE_TYPE"
		localization = "kuat_titan_arrived_desc"
		days = 30
		target = from
		variable = { type = name localization = "capital_planet" scope = root.capital_scope }
	} }
}

#建造袭击者
country_event = {
	id = kuat_shipyard.24
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = resugrant_class_queue value > 0 }
			check_variable = { which = resugrant_class_queue value <= 4 }
		}
		text = kuat_shipyard.24.a.desc
	}
	desc = {
		trigger = {
			check_variable = { which = resugrant_class_queue value > 4 }
		}
		text = kuat_shipyard.24.a5.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = resugrant_class_queue }
				check_variable = { which = resugrant_class_queue value = 0 }
			}
		}
		text = kuat_shipyard.24.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = resurange_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.24.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.check
				get_variable_alloys_check_allow = yes
			}
		}
		custom_tooltip = kuat_shipyard.24.a.tooltip
		hidden_effect = { get_variable_alloys_bought = yes }
		hidden_effect = {
			change_variable = { which = resugrant_class_queue value = 1 }
			country_event = { id = kuat_shipyard.24 }
			country_event = { id = kuat_shipyard.241 days = @kuat_dreadnought_build_time }
		}
	}
	option = {
		name = kuat_shipyard.24.b
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.24.b.need_queue.tooltip
				check_variable = { which = resugrant_class_queue value > 0 }
			}
		}
		custom_tooltip = kuat_shipyard.24.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			subtract_variable = { which = resugrant_class_queue value = 1 }
			country_event = { id = kuat_shipyard.24 }
		}
	}
	option = {
		name = kuat_shipyard.23.b5
		hidden_effect = { set_country_flag = kuat_build_fifth_ships }
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.24.b.need_queue.tooltip
				check_variable = { which = resugrant_class_queue value > 4 }
			}
		}
		custom_tooltip = kuat_shipyard.24.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			remove_country_flag = kuat_build_fifth_ships
			subtract_variable = { which = resugrant_class_queue value = 5 }
			country_event = { id = kuat_shipyard.24 }
		}
	}
	option = {
		name = kuat_shipyard.23.a5
		custom_tooltip = kuat_shipyard.23.a.tooltip
		hidden_effect = { set_country_flag = kuat_build_fifth_ships }
		hidden_effect = { country_event = { id = kuat_shipyard.242 } }
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 } remove_country_flag = building_the_resugrant }
	}
	option = {
		name = kuat_shipyard.exit
		hidden_effect = { remove_country_flag = building_the_resugrant }
		default_hide_option = yes
	}
}

country_event = {
	id = kuat_shipyard.242
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = resugrant_class_queue value > 0 }
			check_variable = { which = resugrant_class_queue value <= 4 }
		}
		text = kuat_shipyard.24.a.desc
	}
	desc = {
		trigger = {
			check_variable = { which = resugrant_class_queue value > 4 }
		}
		text = kuat_shipyard.24.a5.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = resugrant_class_queue }
				check_variable = { which = resugrant_class_queue value = 0 }
			}
		}
		text = kuat_shipyard.24.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = resurange_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.confirm
		custom_tooltip = kuat_shipyard.confirm.c.tooltip
		allow = { custom_tooltip = {
			fail_text = kuat_shipyard_queue
			check_variable = { which = resugrant_queue value > 0 } 
		} }
		hidden_effect = { 
			set_variable = { which = Resugrant_true_numbers value = resugrant_queue }
			change_variable = { which = resugrant_class_queue value = resugrant_queue }
			country_event = { id = kuat_shipyard.24 }
			while = {
				count = Resugrant_true_numbers
				country_event = { id = kuat_shipyard.241 days = @kuat_dreadnought_build_time } 
			}
			remove_country_flag = fired_resugrant
			remove_country_flag = kuat_build_fifth_ships 
			clear_variable = resugrant_queue
			clear_variable = Resugrant_true_numbers
		}
	}
	option = {
		name = kuat_shipyard.return
		default_hide_option = yes
		hidden_effect = { 
			country_event = { id = kuat_shipyard.24 } 
			remove_country_flag = fired_resugrant
			remove_country_flag = kuat_build_fifth_ships
		}
	}
}

#袭击者到达
country_event = {
	id = kuat_shipyard.241
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = resugrant_class_queue value > 0 }
	}
	immediate = {
		if = {
			limit = { check_variable = { which = resugrant_class_queue value > 0 } }
			change_variable = { which = resugrant_fleet_queue value = 1 }
			subtract_variable = { which = resugrant_class_queue value = 1 }
			country_event = { id = kuat_shipyard.243 days = 1 }
		}
		if = {
			limit = { check_variable = { which = resugrant_class_queue value <= 0 } }
			clear_variable = resugrant_class_queue
		}
		if = {
			limit = { exists = event_target:fallen_empire_kuat }
			event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
		}
	}
}

country_event = {
	id = kuat_shipyard.243
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = resugrant_fleet_queue value > 0 }
	}
	immediate = {
		capital_scope = {
			create_fleet = {
				settings = { spawn_debris = no }
				effect = {
					set_owner = root
					while = {
						limit = { root = { check_variable = { which = resugrant_fleet_queue value > 0 } } }
						create_ship = { design = "Name_boss_Resugrant" }
						root = { subtract_variable = { which = resugrant_fleet_queue value = 1 } }
					}
					set_location = { target = prev distance = 20 angle = random }
				}
			}
		}
		set_timed_country_flag = { flag = resugrant_fleet_queue_notification_temple days = 1 }
		country_event = { id = kuat_shipyard.2432 }
	}
}

country_event = {
	id = kuat_shipyard.2432
	hide_window = yes
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = resugrant_fleet_queue_notification_temple } }
	immediate = { create_message = {
		type = "CONSTRUCTION_MESSAGE_TYPE"
		localization = "kuat_resugrant_class_arrived_desc"
		days = 30
		target = from
		variable = { type = name localization = "capital_planet" scope = root.capital_scope }
	} }
}

#建造君权级
country_event = {
	id = kuat_shipyard.25
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = dominance_class_queue value > 0 }
		}
		text = kuat_shipyard.25.a.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = dominance_class_queue }
				check_variable = { which = dominance_class_queue value = 0 }
			}
		}
		text = kuat_shipyard.25.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = Dominence_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.25.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard_fail_tooltip
				get_variable_alloys_check_allow = yes
				count_owned_ship = { limit = { is_ship_size = nebula_dominance } count < 1 }
				check_variable = { which = dominance_class_queue value < 1 }
				check_variable = { which = dominance_check value < 1 }
			}
		}
		custom_tooltip = kuat_shipyard.25.a.tooltip
		hidden_effect = { get_variable_alloys_bought = yes }
		hidden_effect = {
			change_variable = { which = dominance_class_queue value = 1 }
			change_variable = { which = dominance_check value = 1 }
			country_event = { id = kuat_shipyard.25 }
			country_event = { id = kuat_shipyard.251 days = @kuat_dominance_class_build_time }
		}
	}
	option = {
		name = kuat_shipyard.25.b
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.25.b.need_queue.tooltip
				check_variable = { which = dominance_class_queue value > 0 }
			}
		}
		custom_tooltip = kuat_shipyard.25.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			subtract_variable = { which = dominance_class_queue value = 1 }
			subtract_variable = { which = dominance_check value = 1 }
			country_event = { id = kuat_shipyard.25 }
		}
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 } remove_country_flag = building_the_donimance }
	}
	option = {
		name = kuat_shipyard.exit
		hidden_effect = { remove_country_flag = building_the_donimance }
		default_hide_option = yes
	}
}

#君权级到达
country_event = {
	id = kuat_shipyard.251
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = dominance_class_queue value > 0 }
	}
	immediate = {
		if = {
			limit = { count_owned_ship = { limit = { is_ship_size = nebula_dominance } count < 1 } }
			capital_scope = {
				create_fleet = {
					settings = { spawn_debris = no }
					effect = {
						set_owner = root
						create_ship = { design = "Name_boss_Dominance" }
						set_location = { target = prev distance = 20 angle = random }
					}
				}
			}
			create_message = {
				type = "CONSTRUCTION_MESSAGE_TYPE"
				localization = "kuat_dominance_class_arrived_desc"
				days = 30
				target = from
				variable = {
					type = name
					localization = "capital_planet"
					scope = root.capital_scope
				}
			}
			subtract_variable = { which = dominance_class_queue value = 1 }
			if = {
				limit = { check_variable = { which = dominance_class_queue value <= 0 } }
				clear_variable = dominance_class_queue
			}
			if = {
				limit = { exists = event_target:fallen_empire_kuat }
				event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
			}
		}
		else = {
			subtract_variable = { which = dominance_class_queue value = 1 }
			if = {
				limit = { check_variable = { which = dominance_class_queue value <= 0 } }
				clear_variable = dominance_class_queue
			}
			if = {
				limit = { exists = event_target:fallen_empire_kuat }
				event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
			}
		}
	}
}

#建造日蚀级
country_event = {
	id = kuat_shipyard.26
	title = kuat_shipyard.title
	desc = {
		trigger = {
			check_variable = { which = eclipse_class_queue value > 0 }
		}
		text = kuat_shipyard.26.a.desc
	}
	desc = {
		trigger = {
			OR = {
				NOT = { is_variable_set = eclipse_class_queue }
				check_variable = { which = eclipse_class_queue value = 0 }
			}
		}
		text = kuat_shipyard.26.b.desc
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	picture_event_data = { room = Ecelipse_room }
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	option = {
		name = kuat_shipyard.26.a
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.check
				get_variable_alloys_check_allow = yes
			}
			count_owned_ship = { limit = { is_ship_size = eclipse } count < 1 }
			check_variable = { which = eclipse_class_queue value < 1 }
			check_variable = { which = eclipse_class_check value < 1 }
		}
		custom_tooltip = kuat_shipyard.26.a.tooltip
		hidden_effect = { get_variable_alloys_bought = yes }
		hidden_effect = {
			change_variable = { which = eclipse_class_check value = 1 }
			change_variable = { which = eclipse_class_queue value = 1 }
			country_event = { id = kuat_shipyard.26 }
			country_event = { id = kuat_shipyard.261 days = @kuat_eclipse_build_time }
		}
	}
	option = {
		name = kuat_shipyard.26.b
		allow = {
			custom_tooltip = {
				fail_text = kuat_shipyard.26.b.need_queue.tooltip
				check_variable = { which = eclipse_class_queue value > 0 }
			}
		}
		custom_tooltip = kuat_shipyard.26.b.tooltip
		hidden_effect = { get_variable_alloys = yes }
		hidden_effect = {
			subtract_variable = { which = eclipse_class_check value = 1 }
			subtract_variable = { which = eclipse_class_queue value = 1 }
			country_event = { id = kuat_shipyard.26 }
		}
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 } remove_country_flag = building_the_eclipse }
	}
	option = {
		name = kuat_shipyard.exit
		hidden_effect = { remove_country_flag = building_the_eclipse }
		default_hide_option = yes
	}
}

#日蚀级到达
country_event = {
	id = kuat_shipyard.261
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		can_communicate_with_kuat = yes
		check_variable = { which = eclipse_class_queue value > 0 }
	}
	immediate = {
		if = {
			limit = { count_owned_ship = { limit = { is_ship_size = eclipse } count < 1 } }
			capital_scope = {
				create_fleet = {
					settings = { spawn_debris = no }
					effect = {
						set_owner = root
						create_ship = { design = "Name_boss_eclipse" }
						set_location = { target = prev distance = 20 angle = random }
					}
				}
			}
			create_message = {
				type = "CONSTRUCTION_MESSAGE_TYPE"
				localization = "kuat_eclipse_arrived_desc"
				days = 30
				target = from
				variable = {
					type = name
					localization = "capital_planet"
					scope = root.capital_scope
				}
			}
			subtract_variable = { which = eclipse_class_queue value = 1 }
			if = {
				limit = { check_variable = { which = eclipse_class_queue value <= 0 } }
				clear_variable = eclipse_class_queue
			}
			if = {
				limit = { exists = event_target:fallen_empire_kuat }
				event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
			}
		}
		else = {
			subtract_variable = { which = eclipse_class_queue value = 1 }
			if = {
				limit = { check_variable = { which = eclipse_class_queue value <= 0 } }
				clear_variable = eclipse_class_queue
			}
			if = {
				limit = { exists = event_target:fallen_empire_kuat }
				event_target:fallen_empire_kuat = { add_opinion_modifier = { modifier = opinion_kuat_ship_built who = root } }
			}
		}
	}
}

#做出敌对行为后取消舰船建造
country_event = {
	id = kuat_shipyard.3
	title = kuat_shipyard.title
	desc = kuat_shipyard.3.desc
	picture_event_data = {
		portrait = event_target:kuat_player_target_species
		planet_background = pc_ringworld_habitable
		graphical_culture = fallen_empire_01
		city_level = event_target:fallen_empire_kuat
		room = personality_fallen_empire_cyan_room
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	show_sound = event_default
	location = event_target:fallen_empire_kuat.capital_scope
	diplomatic = yes
	is_triggered_only = yes
	trigger = {
		OR = {
			AND = {
				has_origin = origin_kuat_shadow
				exists = event_target:fallen_empire_kuat
				exists = event_target:kuat_shipyard_country
			}
			AND = {
				NOT = { has_origin = origin_kuat_shadow }
				exists = event_target:kuat_shipyard_country
			}
		}
		OR = {
			is_hostile = event_target:fallen_empire_kuat
			is_hostile = event_target:kuat_shipyard_country
		}
		OR = {
			check_variable = { which = fallen_empire_escort_queue value > 0 }
			check_variable = { which = fallen_empire_battlecruiser_queue value > 0 }
			check_variable = { which = fallen_empire_titan_queue value > 0 }
			check_variable = { which = resugrant_class_queue value > 0 }
			check_variable = { which = dominance_class_queue value > 0 }
			check_variable = { which = eclipse_class_queue value > 0 }
		}
	}
	immediate = {
		clear_variable = fallen_empire_escort_queue
		clear_variable = fallen_empire_battlecruiser_queue
		clear_variable = fallen_empire_titan_queue
		clear_variable = resugrant_class_queue
		clear_variable = dominance_class_queue
		clear_variable = eclipse_class_queue
	}
	option = { name = kuat_shipyard.3.a }
} 

#每月检测，夸特消失后摧毁船厂国家
event = {
	id = kuat_shipyard.4
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		any_country = { has_origin = origin_kuat_shadow is_ai = no }
		NOT = { exists = event_target:fallen_empire_kuat }
		exists = event_target:kuat_shipyard_country
	}
	immediate = { event_target:kuat_shipyard_country = { destroy_country = yes } }
}

#TODO 4.6 抽奖
country_event = {
	id = kuat_shipyard.5
	title = kuat_shipyard.title
	desc = kuat_shipyard.5.desc
	picture_event_data = {
		portrait = event_target:kuat_player_target_species
		room = kuat_mega_shipyard_room
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	immediate = {
		if = {
			limit = { NOT = { is_variable_set = kuat_cash_event_variable } }
			set_variable = { which = kuat_cash_event_variable value = 0 }
		}
	}
	#兑换代币
	option = {
		name = kuat_shipyard.5.b
		allow = { 
			custom_tooltip_fail = {
				text = kuat_not_have_enought_resource
				resource_stockpile_compare = { resource = alloys value >= 1000 } 
			}
		}
		hidden_effect = { country_event = { id = kuat_shipyard.6 } }
	}
	#一连抽
	option = {
		name = kuat_shipyard.5.c
		allow = {
			custom_tooltip_fail = {
				text = kuat_not_have_enought_cash
				check_variable = { which = kuat_cash_event_variable value > 0 }
			}
		}
		hidden_effect = {
			subtract_variable = { which = kuat_cash_event_variable value = 1 }
			country_event = { id = kuat_shipyard.5 } 
		}
	}
	#五连抽
	option = {
		name = kuat_shipyard.5.d
		allow = {
			custom_tooltip_fail = {
				text = kuat_not_have_enought_cash
				check_variable = { which = kuat_cash_event_variable value > 4 }
			}
		}
		hidden_effect = {
			subtract_variable = { which = kuat_cash_event_variable value = 5 }
			country_event = { id = kuat_shipyard.5 } 
		}
	}
	#十连抽
	option = {
		name = kuat_shipyard.5.e
		allow = {
			custom_tooltip_fail = {
				text = kuat_not_have_enought_cash
				check_variable = { which = kuat_cash_event_variable value > 9 }
			}
		}
		hidden_effect = {
			subtract_variable = { which = kuat_cash_event_variable value = 10 }
			country_event = { id = kuat_shipyard.5 } 
		}
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.1 } }
	}
	option = {
		name = kuat_shipyard.exit
		default_hide_option = yes
	}
}

country_event = {
	id = kuat_shipyard.6
	title = kuat_shipyard.title
	desc = kuat_shipyard.6.desc
	picture_event_data = {
		portrait = event_target:kuat_player_target_species
		room = kuat_mega_shipyard_room
	}
	custom_gui = "kuat_event_diplomacy_shipyard_window"
	custom_gui_option = "kuat_event_diplomacy_shipyard_option"
	location = event_target:fallen_empire_kuat.capital_scope
	is_triggered_only = yes
	diplomatic = yes
	trigger = {
		is_ai = no
		can_communicate_with_kuat = yes
	}
	immediate = { }
	option = {
		name = kuat_shipyard.6.a
		allow = { 
			custom_tooltip_fail = {
				text = kuat_not_have_enought_resource
				resource_stockpile_compare = { resource = alloys value >= 1000 } 
			}
		}
		hidden_effect = { 
			export_resource_stockpile_to_variable = {
				resource = alloys
				variable = kuat_player_certenly_alloys
			}
			divide_variable = { which = kuat_player_certenly_alloys value = 1000 }
			floor_variable = kuat_player_certenly_alloys
			add_resource = { alloys = -1000 mult = kuat_player_certenly_alloys }
			change_variable = { which = kuat_cash_event_variable value = kuat_player_certenly_alloys }
			country_event = { id = kuat_shipyard.6 } 
		}
	}
	#1
	option = {
		name = kuat_shipyard.6.b
		allow = { 
			custom_tooltip_fail = {
				text = kuat_not_have_enought_resource
				resource_stockpile_compare = { resource = alloys value >= 1000 } 
			}
		}
		hidden_effect = { 
			add_resource = { alloys = -1000 }
			change_variable = { which = kuat_cash_event_variable value = 1 }
			country_event = { id = kuat_shipyard.6 } 
		}
	}
	#10
	option = {
		name = kuat_shipyard.6.c
		allow = { 
			custom_tooltip_fail = {
				text = kuat_not_have_enought_resource
				resource_stockpile_compare = { resource = alloys value >= 10000 } 
			}
		}
		hidden_effect = { 
			add_resource = { alloys = -10000 }
			change_variable = { which = kuat_cash_event_variable value = 10 }
			country_event = { id = kuat_shipyard.6 } 
		}
	}
	#50
	option = {
		name = kuat_shipyard.6.d
		allow = { 
			custom_tooltip_fail = {
				text = kuat_not_have_enought_resource
				resource_stockpile_compare = { resource = alloys value >= 50000 } 
			}
		}
		hidden_effect = { 
			add_resource = { alloys = -50000 }
			change_variable = { which = kuat_cash_event_variable value = 50 }
			country_event = { id = kuat_shipyard.6 } 
		}
	}
	#100
	option = {
		name = kuat_shipyard.6.e
		allow = { 
			custom_tooltip_fail = {
				text = kuat_not_have_enought_resource
				resource_stockpile_compare = { resource = alloys value >= 100000 } 
			}
		}
		hidden_effect = { 
			add_resource = { alloys = -100000 }
			change_variable = { which = kuat_cash_event_variable value = 100 }
			country_event = { id = kuat_shipyard.6 } 
		}
	}
	option = {
		name = kuat_shipyard.return
		hidden_effect = { country_event = { id = kuat_shipyard.5 } }
	}
	option = {
		name = kuat_shipyard.exit
		default_hide_option = yes
	}
}