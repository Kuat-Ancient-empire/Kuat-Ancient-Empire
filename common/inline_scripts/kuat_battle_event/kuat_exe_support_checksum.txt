if = {
	limit = { count_fleet_in_system = {
		count < kuat_super_flagship_$ID$_enough_support_var
		limit = { has_fleet_flag = kuat_super_flagship_$ID$_enough_support_@prev }
	} }
	export_trigger_value_to_variable = {
		trigger = count_fleet_in_system
		parameters = { limit = { has_fleet_flag = kuat_super_flagship_$ID$_enough_support_@prev } }
		variable = kuat_super_flagship_$ID$_enough_support_var_pending
	}
	subtract_variable = {
		which = kuat_super_flagship_$ID$_enough_support_var
		value = kuat_super_flagship_$ID$_enough_support_var_pending
	}
	multiply_variable = {
		which = kuat_super_flagship_$ID$_enough_support_var
		value = $ID$
	}
	change_variable = { which = kuat_support_battle_add_variable value = kuat_super_flagship_$ID$_enough_support_var }
	clear_variable = kuat_super_flagship_$ID$_enough_support_var_pending
	clear_variable = kuat_super_flagship_$ID$_enough_support_var

	every_fleet_in_system = {
		limit = { 
			is_in_combat = yes 
			owner = { is_invisable_faction = no is_ai = no }
			has_enable_flag_ship_system_true = yes 
		}
		if = { 
			limit = { 
				kuat_fleet_cap_occupy = { ID = 3 } 
				solar_system = { check_variable = { which = kuat_support_battle_add_variable value >= 3 } }
			} 
			kuat_battle_kuat_star_flagship_base_calculate = { ID = 3 MULT = 4 }
		}
		else_if = { 
			limit = { 
				kuat_fleet_cap_occupy = { ID = 1.5 } 
				solar_system = { check_variable = { which = kuat_support_battle_add_variable value >= 1.5 } }
			}  
			kuat_battle_kuat_star_flagship_base_calculate = { ID = 1.5 MULT = 2 }
		}
		else_if = { 
			limit = { 
				kuat_fleet_cap_occupy = { ID = 1 } 
				solar_system = { check_variable = { which = kuat_support_battle_add_variable value >= 1 } }
			} 
			kuat_battle_kuat_star_flagship_base_calculate = { ID = 1 MULT = 1 }
		}
		else_if = {
			limit = { kuat_fleet_cap_flag_condition = yes }
			solar_system = { prev = { 
				kuat_battle_remove_repetable_modifier_iep = yes
				kuat_battle_kuat_star_flagship_base_fleet_clear_calculation = { ID = 1 }
				kuat_battle_kuat_star_flagship_base_fleet_clear_calculation = { ID = 1.5 }
				kuat_battle_kuat_star_flagship_base_fleet_clear_calculation = { ID = 3 }
				kuat_battle_notification_suppliment_fleet = yes
			} }
		}
	}
}