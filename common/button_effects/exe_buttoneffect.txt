#Scope type varies depending on what is selected
# This = selected object or player country
# From = player country
# STAR_WAR_MENUE_1 = {
# 	potential = {
# 		always = yes
# 	}
# 	allow = {
# 		hidden_trigger = {
# 			has_global_flag = install_kuat_mod
# 		}
# 	}
# 	effect = {
# 		custom_tooltip = "TOPBAR_MENU_STAR_WAR"
# 		country_event = { id = exe_invasion.1000 }
# 	}
# }
kuat_set_forcetrigger_order_66_group = {
	potential = { NOT = { has_global_flag = kuat_set_forcetrigger_order_66_group_enable } }
	allow = { hidden_trigger = { is_scope_type = country NOT = { has_global_flag = kuat_set_forcetrigger_order_66_group_disable } } }
	effect = {  
		custom_tooltip = "kuat_set_forcetrigger_order_66_group_tip"
		hidden_effect = { from = { set_global_flag = kuat_set_forcetrigger_order_66_group_enable } }
	}
}

kuat_set_forcetrigger_order_alt_66_group = {
	potential = { has_global_flag = kuat_set_forcetrigger_order_66_group_enable }
	allow = { hidden_trigger = { is_scope_type = country NOT = { has_global_flag = kuat_set_forcetrigger_order_66_group_disable } } }
	effect = {  
		custom_tooltip = "kuat_set_forcetrigger_order_alt_66_group_tip"
		hidden_effect = { from = { 
			if = {
				limit = { NOR = { 
					has_origin = origin_eternalthrone 
					has_origin = origin_kuat_apocalyptic
					has_origin = origin_kuat_shadow
				} }
				change_variable = { which = order_6_games_value value = 1 } 
			}
			if = {
				limit = { 
					NOT = { has_global_flag = kuat_settings_first_fired }
					NOT = { has_country_flag = has_origin_kuat_shadow }
					check_variable = { which = order_6_games_value value = 2 } 
				}
				set_country_flag = has_origin_kuat_shadow
				play_sound = event_construction
				clear_variable = order_6_games_value
			}
			change_variable = { which = order_66_games_value value = 1 } 
			if = {
				limit = { check_variable = { which = order_66_games_value value = 66 } }
				kuat_origin_give_all_ship_and_tech = yes
				play_sound = order_66_completed_speech
				clear_variable = order_66_games_value
				set_global_flag = kuat_set_forcetrigger_order_66_group_disable
			}
		} }
	}
}

#diffult
kuat_set_difficulty_group = {
	potential = { always = yes }
	allow = { always = yes }
	effect = { }
}
kuat_set_difficulty_easy = {
	potential = { hidden_trigger = { always = yes } }
	allow = { hidden_trigger = { from = { 
		kuat_is_enable_shadow_origin = yes 
		NOT = { has_tradition = tr_kuat_scum_finish }
	} } }
	effect = {
		custom_tooltip = "exe_invasion.1001.c"
		custom_tooltip = "exe_invasion.1001.c.tooltip"
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_global_flag = ban_exe_invasion
						has_global_flag = normal_exe_invasion
						has_global_flag = difficult_exe_invasion
						has_global_flag = fire_diificult_option
					}
				}
				remove_global_flag = ban_exe_invasion
				remove_global_flag = normal_exe_invasion
				remove_global_flag = difficult_exe_invasion
				remove_global_flag = fire_diificult_option
			}
			set_global_flag = easy_exe_invasion
			event_target:global_event_country = { 
				set_variable = { which = exe_invasion_difficult_global_var value = 1 } 
				if = {
					limit = { has_global_flag = enable_modifer_check }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 1 }
				}
				if = {
					limit = { has_global_flag = kuat_impulse_mod_settings }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 1 }
				}
			}
			set_global_flag = fire_diificult_option
			from = { country_event = { id = exe_invasion.1004 } }
		}
	}
}
kuat_set_difficulty_easy_alt = {
	potential = {
		hidden_trigger = {  has_global_flag = easy_exe_invasion } 
	}
	allow = { hidden_trigger = { from = { kuat_is_enable_shadow_origin = yes } } }
	effect = {
		custom_tooltip = "exe_invasion.1001.c"
		custom_tooltip = "exe_invasion.1009.desc"
	}
}
kuat_set_difficulty_normal = {
	potential = { hidden_trigger = { always = yes } }
	allow = { hidden_trigger = { from = { 
		kuat_is_enable_shadow_origin = yes 
		NOT = { has_tradition = tr_kuat_scum_finish }
	} } }
	effect = {
		custom_tooltip = "exe_invasion.1001.b"
		custom_tooltip = "exe_invasion.1001.b.tooltip"
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_global_flag = ban_exe_invasion
						has_global_flag = easy_exe_invasion
						has_global_flag = difficult_exe_invasion
						has_global_flag = fire_diificult_option
					}
				}
				remove_global_flag = ban_exe_invasion
				remove_global_flag = easy_exe_invasion
				remove_global_flag = difficult_exe_invasion
				remove_global_flag = fire_diificult_option
			}
			event_target:global_event_country = { 
				set_variable = { which = exe_invasion_difficult_global_var value = 2 } 
				if = {
					limit = { has_global_flag = enable_modifer_check }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 1.5 }
				}
				if = {
					limit = { has_global_flag = kuat_impulse_mod_settings }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 2 }
				}
			}
			set_global_flag = normal_exe_invasion
			set_global_flag = fire_diificult_option
			from = { country_event = { id = exe_invasion.1004 } }
		}
	}
}
kuat_set_difficulty_normal_alt = {
	potential = { hidden_trigger = { has_global_flag = normal_exe_invasion } }
	allow = { hidden_trigger = { from = { kuat_is_enable_shadow_origin = yes } } }
	effect = {
		custom_tooltip = "exe_invasion.1001.b"
		custom_tooltip = "exe_invasion.1009.normal"
	}
}
kuat_set_difficulty_hard_1 = {
	potential = { hidden_trigger = { always = yes } }
	allow = { hidden_trigger = { from = { kuat_is_enable_shadow_origin = yes } } }
	effect = {
		custom_tooltip = "exe_invasion.1001.d"
		custom_tooltip = "exe_invasion.1001.d.tooltip"
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_global_flag = ban_exe_invasion
						has_global_flag = normal_exe_invasion
						has_global_flag = easy_exe_invasion
						has_global_flag = fire_diificult_option
					}
				}
				remove_global_flag = ban_exe_invasion
				remove_global_flag = normal_exe_invasion
				remove_global_flag = easy_exe_invasion
				remove_global_flag = fire_diificult_option
			}
			event_target:global_event_country = { 
				set_variable = { which = exe_invasion_difficult_global_var value = 3 } 
				if = {
					limit = { has_global_flag = enable_modifer_check }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 2 }
				}
				if = {
					limit = { has_global_flag = kuat_impulse_mod_settings }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 3 }
				}
			}
			set_global_flag = difficult_exe_invasion
			set_global_flag = fire_diificult_option
			from = { country_event = { id = exe_invasion.1004 } }
		}
	}
}
kuat_set_difficulty_hard_1_alt = {
	potential = { hidden_trigger = { has_global_flag = difficult_exe_invasion } }
	allow = { hidden_trigger = { from = { kuat_is_enable_shadow_origin = yes } } }
	effect = {
		custom_tooltip = "exe_invasion.1001.d"
		custom_tooltip = "exe_invasion.1009.difficult"
	}
}
kuat_set_difficulty_ban = {
	potential = { hidden_trigger = { always = yes } }
	allow = { hidden_trigger = { from = { kuat_is_enable_shadow_origin = yes } } }
	effect = {
		custom_tooltip = "exe_invasion.1001.g"
		custom_tooltip = "exe_invasion.1001.g.tooltip"
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_global_flag = easy_exe_invasion
						has_global_flag = normal_exe_invasion
						has_global_flag = difficult_exe_invasion
						has_global_flag = fire_diificult_option
					}
				}
				remove_global_flag = easy_exe_invasion
				remove_global_flag = normal_exe_invasion
				remove_global_flag = difficult_exe_invasion
				remove_global_flag = fire_diificult_option
			}
			event_target:global_event_country = { 
				set_variable = { which = exe_invasion_difficult_global_var value = 4 }
				if = {
					limit = { has_global_flag = enable_modifer_check }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 2.5 }
				}
				if = {
					limit = { has_global_flag = kuat_impulse_mod_settings }
					multiply_variable = { which = exe_invasion_difficult_global_var value = 4 }
				}
			}
			set_global_flag = ban_exe_invasion
			set_global_flag = fire_diificult_option
			from = { country_event = { id = exe_invasion.1004 } }
		}
	}
}
kuat_set_difficulty_ban_alt = {
	potential = { hidden_trigger = { has_global_flag = ban_exe_invasion } }
	allow = { hidden_trigger = { from = { kuat_is_enable_shadow_origin = yes } } }
	effect = {
		custom_tooltip = "exe_invasion.1001.g"
		custom_tooltip = "exe_invasion.1009.ban"
	}
}

#dynamic modifier system
kuat_set_check_group = {
	potential = { always = yes }
	allow = { always = yes }
	effect = { }
}
kuat_set_check_one = {
	potential = { always = yes }
	allow = { hidden_trigger = { has_global_flag = fire_diificult_option kuat_is_enable_shadow_origin = yes } }
	effect = {
		custom_tooltip = "exe_invasion.1112.e"
		custom_tooltip = "exe_invasion.1112.e.tooltip"
		custom_tooltip = "exe_invasion.1112.tooltip"
		hidden_effect = {
			remove_global_flag = disable_modifer_check
			set_global_flag = enable_modifer_check
			switch = {
				trigger = has_global_flag
				easy_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 1 } 
					multiply_variable = { which = exe_invasion_difficult_global_var value = 1 }
					if = {
						limit = { has_global_flag = kuat_impulse_mod_settings }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 1 }
					}
				} }
				normal_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 2 } 
					multiply_variable = { which = exe_invasion_difficult_global_var value = 1.5 }
					if = {
						limit = { has_global_flag = kuat_impulse_mod_settings }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 2 }
					}
				} }
				difficult_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 3 } 
					multiply_variable = { which = exe_invasion_difficult_global_var value = 2 }
					if = {
						limit = { has_global_flag = kuat_impulse_mod_settings }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 3 }
					}
				} }
				ban_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 4 } 
					multiply_variable = { which = exe_invasion_difficult_global_var value = 2.5 }
					if = {
						limit = { has_global_flag = kuat_impulse_mod_settings }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 4 }
					}
				} }
			}
		}
	}
}
kuat_set_check_one_alt = {
	potential = { hidden_trigger = {
		has_global_flag = enable_modifer_check
	} }
	allow = { hidden_trigger = { has_global_flag = fire_diificult_option kuat_is_enable_shadow_origin = yes } }
	effect = {
		custom_tooltip = "exe_invasion.1112.e"
		custom_tooltip = "exe_invasion.1112.e.enable"
	}
}
kuat_set_check_two = {
	potential = { always = yes }
	allow = { hidden_trigger = { 
		has_global_flag = fire_diificult_option 
		kuat_is_enable_shadow_origin = yes 
		NOT = { has_tradition = tr_kuat_scum_finish }
	} }
	effect = {
		custom_tooltip = "exe_invasion.1111.e"
		custom_tooltip = "exe_invasion.1111.e.tooltip"
		custom_tooltip = "exe_invasion.1111.tooltip"
		hidden_effect = {
			remove_global_flag = enable_modifer_check
			set_global_flag = disable_modifer_check
			switch = {
				trigger = has_global_flag
				easy_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 1 }
				} }
				normal_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 1.5 }
				} }
				difficult_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 2 }
				} }
				ban_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 2.5 }
				} }
			}
		}
	}
}
kuat_set_check_two_alt = {
	potential = { hidden_trigger = {
		has_global_flag = disable_modifer_check
	} }
	allow = { hidden_trigger = { has_global_flag = fire_diificult_option kuat_is_enable_shadow_origin = yes } }
	effect = {
		custom_tooltip = "exe_invasion.1111.e"
		custom_tooltip = "exe_invasion.1111.e.disbale"
	}
}

#animal trigger
kuat_animal_trigger_group = {
	potential = { always = yes }
	allow = { hidden_trigger = { from = { OR = { has_origin = origin_eternalthrone kuat_is_enable_shadow_origin = yes } } } }
	effect = { }
}
kuat_animal_trigger_enable = {
	potential = { always = yes }
	allow = { hidden_trigger = { from = { OR = { has_origin = origin_eternalthrone kuat_is_enable_shadow_origin = yes } } } }
	effect = { hidden_effect = {
		remove_global_flag = disable_animal_trigger
		remove_global_flag = enable_animal_trigger
		set_global_flag = enable_animal_trigger
		if = {
			limit = { has_origin = origin_eternalthrone }
			if = {
				limit = { exists = event_target:CHECK_ETERNAL_LEADER }
				clear_global_event_target = ETERNAL_LEADER
				random_galaxy_species = {
					limit = { is_same_value = event_target:CHECK_ETERNAL_LEADER }
					save_global_event_target_as = ETERNAL_LEADER
				}
			}
			else = { kuat_kae_create_faction_species = yes }
		}
		else_if = {
			limit = { kuat_is_enable_shadow_origin = yes }
			if = {
				limit = { exists = event_target:CHECK_UTS02_LEADER }
				clear_global_event_target = UTS02_LEADER
				random_galaxy_species = {
					limit = { is_same_value = event_target:CHECK_UTS02_LEADER }
					save_global_event_target_as = UTS02_LEADER
				}
			}
			else = { kuat_Uts02_create_faction_species = yes }
		}
	} }
}
kuat_animal_trigger_enable_alt = {
	potential = { hidden_trigger = { has_global_flag = enable_animal_trigger } }
	allow = { hidden_trigger = { from = { OR = { has_origin = origin_eternalthrone kuat_is_enable_shadow_origin = yes } } } }
	effect = { }
}
kuat_animal_trigger_disable = {
	potential = { always = yes }
	allow = { hidden_trigger = { from = { OR = { has_origin = origin_eternalthrone kuat_is_enable_shadow_origin = yes } } } }
	effect = { hidden_effect = {
		remove_global_flag = disable_animal_trigger
		remove_global_flag = enable_animal_trigger
		set_global_flag = disable_animal_trigger
		if = {
			limit = { has_origin = origin_eternalthrone }
			clear_global_event_target = ETERNAL_LEADER
			from = { ruler = { save_global_event_target_as = ETERNAL_LEADER } }
		}
		else_if = {
			limit = { kuat_is_enable_shadow_origin = yes }
			clear_global_event_target = UTS02_LEADER
			from = { ruler = { save_global_event_target_as = UTS02_LEADER } }
		}
	} }
}
kuat_animal_trigger_disable_alt = {
	potential = { hidden_trigger = { has_global_flag = disable_animal_trigger } }
	allow = { hidden_trigger = { from = { OR = { has_origin = origin_eternalthrone kuat_is_enable_shadow_origin = yes } } } }
	effect = { }
}


#ai trigger
kuat_ai_trigger_group = {
	potential = { always = yes }
	allow = { always = yes }
	effect = { }
}
kuat_ai_trigger_enable = {
	potential = { always = yes }
	allow = { always = yes }
	effect = { hidden_effect = {
		remove_global_flag = disable_ai_trigger
		remove_global_flag = enable_ai_trigger
		set_global_flag = enable_ai_trigger
	} }
}
kuat_ai_trigger_enable_alt = {
	potential = { hidden_trigger = { has_global_flag = enable_ai_trigger } }
	allow = { always = yes }
	effect = { }
}
kuat_ai_trigger_disable = {
	potential = { always = yes }
	allow = { always = yes }
	effect = { hidden_effect = {
		remove_global_flag = disable_ai_trigger
		remove_global_flag = enable_ai_trigger
		set_global_flag = disable_ai_trigger
	} }
}
kuat_ai_trigger_disable_alt = {
	potential = { hidden_trigger = { has_global_flag = disable_ai_trigger } }
	allow = { always = yes }
	effect = { }
}

#super OP
kuat_set_return_group = {
	potential = { always = yes }
	allow = { always = yes }
	effect = { }
}
kuat_set_return_one = {
	potential = { always = yes }
	allow = { always = yes }
	effect = {
		custom_tooltip = "exe_invasion.1010.e"
		custom_tooltip = "exe_invasion.1010.e.tooltip"
		hidden_effect = {
			remove_global_flag = kuat_impulse_mod_settings
			remove_global_flag = kuat_impulse_mod_settings_disable
			set_global_flag = kuat_impulse_mod_settings
			switch = {
				trigger = has_global_flag
				easy_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 1 } 
					if = {
						limit = { has_global_flag = enable_modifer_check }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 1 }
					}
					multiply_variable = { which = exe_invasion_difficult_global_var value = 1 }
				} }
				normal_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 2 } 
					if = {
						limit = { has_global_flag = enable_modifer_check }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 1.5 }
					}
					multiply_variable = { which = exe_invasion_difficult_global_var value = 2 }
				} }
				difficult_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 3 } 
					if = {
						limit = { has_global_flag = enable_modifer_check }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 2 }
					}
					multiply_variable = { which = exe_invasion_difficult_global_var value = 3 }
				} }
				ban_exe_invasion = { event_target:global_event_country = {
					set_variable = { which = exe_invasion_difficult_global_var value = 4 } 
					if = {
						limit = { has_global_flag = enable_modifer_check }
						multiply_variable = { which = exe_invasion_difficult_global_var value = 2.5 }
					}
					multiply_variable = { which = exe_invasion_difficult_global_var value = 4 }
				} }
			}
		}
		from = { country_event = { id = exe_invasion.1004 } }
	}
}
kuat_set_return_one_alt = {
	potential = { hidden_trigger = { has_global_flag = kuat_impulse_mod_settings } }
	allow = { always = yes }
	effect = { 
		custom_tooltip = "exe_invasion.1010.e"
		custom_tooltip = "exe_invasion.1010.e.tooltip"
	}
}
kuat_set_return_two = {
	potential = { always = yes }
	allow = { always = yes }
	effect = {
		custom_tooltip = "exe_invasion.1001.e"
		custom_tooltip = "exe_invasion.1001.e.tooltip"
		hidden_effect = {
			remove_global_flag = kuat_impulse_mod_settings
			remove_global_flag = kuat_impulse_mod_settings_disable
			set_global_flag = kuat_impulse_mod_settings_disable
			switch = {
				trigger = has_global_flag
				easy_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 1 }
				} }
				normal_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 2 }
				} }
				difficult_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 3 }
				} }
				ban_exe_invasion = { event_target:global_event_country = {
					divide_variable = { which = exe_invasion_difficult_global_var value = 4 }
				} }
			}
		}
	}
}
kuat_set_return_two_alt = {
	potential = { hidden_trigger = { has_global_flag = kuat_impulse_mod_settings_disable } }
	allow = { always = yes }
	effect = { 
		custom_tooltip = "exe_invasion.1001.e"
		custom_tooltip = "exe_invasion.1001.e.tooltip"
	}
}

kuat_set_cash_code_group = {
	potential = { always = yes }
	allow = { always = yes }
	effect = { hidden_effect = { from = { 
		change_variable = { which = num_cash_code_kuat value = 1 } 
		if = { limit = { check_variable = { which = num_cash_code_kuat value >= 3 } } set_variable = { which = num_cash_code_kuat value = 0 } }
		country_event = { id = executor_build.1007 }
	} } }
}

kuat_set_cash_code_paypel = {
	potential = { from = { check_variable = { which = num_cash_code_kuat value = 2 } } }
	allow = { always = yes }
	effect = { }
}

kuat_set_cash_code_aifadian = {
	potential = { from = { check_variable = { which = num_cash_code_kuat value = 1 } } }
	allow = { always = yes }
	effect = { }
}

# kuat_set_cash_code_wechat = {
# 	potential = { from = { check_variable = { which = num_cash_code_kuat value = 3 } } }
# 	allow = { always = yes }
# 	effect = { }
# }





kuat_fleet_attack_action = {
	potential = { hidden_trigger = { 
		MUI_trgr_flt_SWITCH_mods = yes
		is_scope_type = fleet 
		OR = {
			is_ship_class = shipclass_military
			is_ship_class = shipclass_military_special
			is_ship_class = shipclass_transport
		}
		NOT = { has_fleet_flag = kuat_auto_fleet_system } 
	} }
	allow = { 
		custom_tooltip = "kuat_fleet_attack_action_allow"
		hidden_trigger = { exists = owner owner = { is_at_war = yes } } 
	}
	effect = {  
		custom_tooltip = "kuat_fleet_attack_action"
		hidden_effect = { if = {
			limit = { is_scope_type = fleet }
			set_fleet_flag = fire_kuat_fleet_attack_action
			owner = { save_global_event_target_as = kuat_friendly_faction }
			switch = {
				trigger = is_ship_class
				shipclass_military = { set_automatic_fleet_avaliable = {
					TYPE = millatry_automatic_action
					FRIENDLY_TARGET = event_target:kuat_friendly_faction
				} }
				shipclass_military_special = { set_automatic_fleet_avaliable = { 
					TYPE = colossus_automatic_action  
					FRIENDLY_TARGET = event_target:kuat_friendly_faction 
				} }
				shipclass_transport = { set_automatic_fleet_avaliable = { 
					TYPE = transport_automatic_action  
					FRIENDLY_TARGET = event_target:kuat_friendly_faction 
				} }
			}
		} }
	}
}

kuat_fleet_attack_action_alt = {
	potential = { hidden_trigger = { 
		MUI_trgr_flt_SWITCH_mods = yes 
		is_scope_type = fleet 
		has_fleet_flag = kuat_auto_fleet_system 
	} }
	allow = { hidden_trigger = { has_fleet_flag = fire_kuat_fleet_attack_action } }
	effect = {  
		custom_tooltip = kuat_fleet_attack_action_alt
		hidden_effect = {
			remove_fleet_flag = fire_kuat_fleet_attack_action
			remove_automatic_fleet_avaliable = yes
		}
	}
}

kuat_fleet_defence_action = {
	potential = { hidden_trigger = { 
		MUI_trgr_flt_SWITCH_mods = yes
		is_scope_type = fleet is_ship_class = shipclass_military
		NOT = { has_fleet_flag = kuat_auto_fleet_system } 
	} }
	allow = { always = yes }
	effect = {  
		custom_tooltip = kuat_fleet_defense_action
		hidden_effect = { if = {
			limit = { is_scope_type = fleet }
			set_fleet_flag = fire_kuat_fleet_defense_action
			owner = { save_global_event_target_as = kuat_friendly_faction }
			set_automatic_fleet_avaliable = { 
				TYPE = defender_automatic_action  
				FRIENDLY_TARGET = event_target:kuat_friendly_faction 
			}
		}}
	}
}

kuat_fleet_defence_action_alt = {
	potential = { hidden_trigger = { 
		MUI_trgr_flt_SWITCH_mods = yes 
		is_scope_type = fleet 
		has_fleet_flag = kuat_auto_fleet_system 
	} }
	allow = { hidden_trigger = { has_fleet_flag = fire_kuat_fleet_defense_action } }
	effect = { 
		custom_tooltip = kuat_fleet_defense_action_alt_name
		hidden_effect = { 
			remove_fleet_flag = fire_kuat_fleet_defense_action
			remove_automatic_fleet_avaliable = yes 
		}
	}
}