##check allow
##GET KUAT SHIPYARD ALLOYS
kuat_shipyard_check_allow_resource = {
	optimize_memory
	resource_stockpile_compare = {
		resource = alloys
		value >= $first_alloys$
	}
}

#cost
get_running_variable_check_allow_alloys = {
	optimize_memory
	kuat_shipyard_check_allow_resource = { first_alloys = @\[ $second_alloys$ * $basic$ ] }
}

get_ship_alloys_allow = {
	optimize_memory
	if = {
		limit = { has_country_flag = building_the_horriwer }
		if = {
			limit = { NOT = { has_country_flag = fire_five_impirial } }
			get_running_variable_check_allow_alloys = { second_alloys = 20000 basic = $basic$ }
		}
		if = {
			limit = { has_country_flag = fire_five_impirial }
			get_running_variable_check_allow_alloys = { second_alloys = 120000 basic = $basic$ }
		} 
	}
	else_if = {
		limit = { has_country_flag = building_the_empire } 
		if = {
			limit = { NOT = { has_country_flag = fire_five_impirial } }
			get_running_variable_check_allow_alloys = { second_alloys = 50000 basic = $basic$ }
		}
		if = {
			limit = { has_country_flag = fire_five_impirial }
			get_running_variable_check_allow_alloys = { second_alloys = 300000 basic = $basic$ }
		}
	}
	else_if = {
		limit = { has_country_flag = building_the_resugrant }
		if = {
			limit = { NOT = { has_country_flag = fire_five_impirial } }
			get_running_variable_check_allow_alloys = { second_alloys = 100000 basic = $basic$ }
		}
		if = {
			limit = { has_country_flag = fire_five_impirial }
			get_running_variable_check_allow_alloys = { second_alloys = 600000 basic = $basic$ }
		} 
	}
	else_if = {
		limit = { has_country_flag = building_the_donimance }
		get_running_variable_check_allow_alloys = { second_alloys = 150000 basic = $basic$ }
	}
	else_if = {
		limit = { has_country_flag = building_the_eclipse }
		get_running_variable_check_allow_alloys = { second_alloys = 300000 basic = $basic$ }
	}
	else_if = {
		limit = { has_country_flag = building_the_Vengeance }
		get_running_variable_check_allow_alloys = { second_alloys = 300000 basic = $basic$ }
	}
}

get_variable_alloys_check_allow = {
	optimize_memory
	if = {
		limit = { event_target:fallen_empire_kuat = { opinion = { who = root value > 999 } } }
		get_ship_alloys_allow = { basic = 0.75 } 
	} 
	else_if = {
		limit = { event_target:fallen_empire_kuat = { opinion = { who = root value > 899 } } }
		get_ship_alloys_allow = { basic = 0.8 } 
	}
	else_if = {
		limit = { event_target:fallen_empire_kuat = { opinion = { who = root value > 699 } } }
		get_ship_alloys_allow = { basic = 0.85 } 
	}
	else_if = {
		limit = { event_target:fallen_empire_kuat = { opinion = { who = root value > 499 } } }
		get_ship_alloys_allow = { basic = 0.9 } 
	}
	else_if = {
		limit = { event_target:fallen_empire_kuat = { opinion = { who = root value > 299 } } }
		get_ship_alloys_allow = { basic = 0.95 } 
	}
	else_if = {
		limit = { OR = {
			event_target:fallen_empire_kuat = { opinion = { who = root value > 99 } }
			root = { has_ascension_perk = ap_shenhai_silent }
		} }
		get_ship_alloys_allow = { basic = 1 } 
	}
}